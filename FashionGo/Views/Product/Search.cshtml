@model PagedList.IPagedList<FashionGo.Models.Entities.Product>
@using FashionGo.Models.Entities
@using System.Web.Configuration
@using PagedList.Mvc;

@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var rd = new Random();
}

@section HeaderMetas
{
    <meta name="description" content="Kết quả tìm kiếm: @ViewBag.Title" />
    <meta name="keywords" content="@ViewBag.keyword" />
    <meta name="author" content="FashionGo.vn" />
    <meta property="og:url" content="@Request.Url.AbsoluteUri" />
    <meta property="og:type" content="Product" />
    <meta property="og:title" content="@Html.Raw(ViewBag.Title)" />
    <meta property="og:description" content="Kết quả tìm kiếm: @ViewBag.Title" />
}

<div class="wrap-content">
    <div id="system-message-container">
    </div>
    <script src="~/Scripts/components/com_eshop/assets/js/jquery.cookie.js" type="text/javascript"></script>
    <script src="~/Scripts/components/com_eshop/assets/js/layout.js" type="text/javascript"></script>
    <script>
    jQuery(function ($) {
        $(document).ready(function () {
            changeLayout('grid');
        });
    });
    </script>
    <h1 class="eshop-category-title"style="text-transform: none; font-family: Arial; font-weight: 100;">@ViewBag.Title</h1>
    <div class="eshop-products-list">
        <div id="products-list-container" class="products-list-container block grid">
            <div class="sortPagiBar row-fluid clearfix">
                <div class="span3">
                    <div class="btn-group hidden-phone">
                        <a rel="grid" href="#" class="btn grid"><i class="icon-th-large"></i></a>
                        <a rel="list" href="#" class="btn list"><i class="icon-th-list"></i></a>
                    </div>
                </div>
                <div class="span9">
                    <form action="/Product/Search" method="get">
                        <input type="hidden" value="@ViewBag.keyword" name="keyword" />
                        <div class="clearfix">
                            <div class="eshop-product-show">
                                <b>Xem: </b>
                                <select id="limit" name="limit" class="inputbox input-mini" size="1" onchange="this.form.submit()" autocomplete="off">
                                    @if (ViewBag.CurrentFilters != null)
                                    {
                                        <option value="@ViewBag.CurrentFilters" selected>Đang chọn @ViewBag.CurrentFilters </option>
                                    }
                                    <option value="10">10</option>
                                    <option value="30">30</option>
                                    <option value="45">45</option>
                                    <option value="90">90</option>
                                    <option value="@Model.Count()">Xem tất cả</option>
                                </select>
                            </div>
                            <div class="eshop-product-sorting">
                                <b>Sắp xếp theo: </b>
                                @Html.DropDownList("sort_options", new SelectList(
                        new List<Object>{
                      new { value = "product_name-ASC", text = "Tên sản phẩm (A - Z)" },
                      new { value = "product_name-DESC", text = "Tên sản phẩm (Z - A)" },
                      new { value = "product_price-ASC", text = "Giá tăng dần" },
                      new { value = "product_price-DESC", text = "Giá giảm dần" }
                               }, "value", "text", ViewBag.CurrentSort),
                        new { @class = "inputbox input-xlarge", onchange = "this.form.submit();" })
                            </div>
                        </div>
                    </form>
                </div>
            </div>
            <div id="products-list" class="row-fluid clearfix">
                @{
                    var clearfixDivStart = "<div class='clearfix'>";
                    var clearfixDivEnd = "</div>";
                    var stt = 1;
                }
                @foreach (var item in Model)
                {
                    if (stt % 3 == 1)
                    {
                        @Html.Raw(clearfixDivStart)
                    }

                    <div class="span4 ajax-block-product spanbox clearfix">
                        <div class="row">
                            <div class="eshop-wrap-image col-md-4">
                                <div class="eshop-image-block">
                                    <div class="image">
                                        <a href="@Url.RouteUrl("ProductDetails", new { slug = item.Name.ToAscii(), id = item.Id })" title="@item.Name" class="product-image">
                                            <img id="product-image-@item.Id" style="width: 100%" src="@item.FeaturedImage" title="@item.Name" alt="@item.Name">
                                        </a>
                                        <span class="overlay-background-color">&nbsp;</span>
                                    </div>

                                    <div class="eshop-buttons">
                                        <p>
                                            <a class="button" style="cursor: pointer;" onclick="addToWishList(this,@item.Id, '@WebConfigurationManager.AppSettings["SiteName"].ToString()')" title="Đánh dấu sản phẩm yêu thích">
                                            <i class="fa fa-heart"></i><span class="text-hide">Yêu thích</span></a>
                                            <a class="button" style="cursor: pointer;" href="@Url.RouteUrl("ProductDetails", new { slug = item.Name.ToAscii(), id = item.Id })" title="Xem chi tiết"><i class="fa fa-arrow-right"></i><span class="text-hide">Chi tiết</span></a>
                                        </p>

                                        <div class="eshop-cart-area">
                                            <button id="add-to-cart-@item.Id" class="btn btn-primary" onclick="flyToCart(@item.Id);">Thêm vào giỏ</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="eshop-info col-md-8">
                                <div class="eshop-info-block">
                                    <h4 class="eshop-product-title "style="text-transform: none; font-family: Arial; font-weight: 100;">
                                        <a href="@Url.RouteUrl("ProductDetails", new { slug = item.Name.ToAscii(), id = item.Id })" title="@item.Name"style="text-transform: none; font-family: Arial; font-weight: 100;">@item.Name</a>
                                    </h4>
                                    <div class="eshop-product-desc">
                                        @item.Description
                                    </div>
                                    <div class="row eshop-table">
                                        <div class="eshop-product-review col-xs-6 col-sm-6">
                                            <span itemprop="review" itemscope="" itemtype="http://schema.org/Review-aggregate">
                                                <i class="fa fa-tag" aria-hidden="true"></i>@rd.Next(10)
                                                <i class="fa fa-eye" aria-hidden="true"></i>@item.Views
                                            </span>
                                        </div>
                                        <div class="eshop-product-price col-xs-6 col-sm-6">
                                            <p>
                                                @if (item.Discount.Value > 0)
                                                {
                                                    <span class="eshop-base-price">@Html.FormatValue(item.Price, "{0:0,0}")đ</span>
                                                }
                                                <span class="eshop-sale-price">@Html.FormatValue(item.PriceAfter, "{0:0,0}")đ</span>
                                            </p>
                                        </div>
                                    </div>
                                    <div class="eshop-buttons">
                                        <div class="eshop-cart-area">
                                            <div class="input-append input-prepend input-group bootstrap-touchspin">
                                                <span class="eshop-quantity">
                                                    <input type="text" class="eshop-quantity-value" id="quantity_@item.Id" name="quantity" value="1">
                                                    <span class="input-group-btn-vertical">
                                                        <a class="btn btn-default button-plus" id="@item.Id" data="up"><i class="icon-chevron-up"></i></a>
                                                        <a class="btn btn-default button-minus" id="@item.Id" data="down"><i class="icon-chevron-down"></i></a>
                                                    </span>
                                                </span>
                                            </div>
                                            <button id="add-to-cart-@item.Id" class="btn btn-primary" onclick="flyToCart(@item.Id);" value="Thêm vào giỏ">
                                                <i class="fa fa-shopping-cart">&nbsp;</i>&nbsp;Thêm vào giỏ
                                            </button>
                                        </div>
                                        <p>
                                            <a class="btn button" style="cursor: pointer;" onclick="addToWishList(this,@item.Id, '@WebConfigurationManager.AppSettings["SiteName"].ToString()')" title="Đánh dấu sản phẩm yêu thích"><i class="fa fa-heart"></i>Đánh dấu Yêu thích</a>
                                            <a class="btn button" style="cursor: pointer;" href="@Url.RouteUrl("ProductDetails", new { slug = item.Name.ToAscii(), id = item.Id })" title="Xem chi tiết">Chi tiết <i class="fa fa-arrow-right"></i></a>
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    if (stt % 3 == 0 || stt == Model.Count())
                    {
                        @Html.Raw(clearfixDivEnd)
                    }
                    stt++;
                }

                <div class="row-fluid">
                    <div class="pagination">
                        @Html.PagedListPager(Model, page => Url.HttpRouteUrl("SearchProduct", new { keyword = ViewBag.keyword, page = page }))
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
